<!DOCTYPE html>
<html lang="en">

<head>
  <!-- ## for client-side less
  <link rel="stylesheet/less" type="text/css" href="http://cmsj.net/theme/css/style.less">
  <script src="//cdnjs.cloudflare.com/ajax/libs/less.js/1.7.3/less.min.js" type="text/javascript"></script>
  -->


  <link rel="icon" type="image/vnd.microsoft.icon" href="http://cmsj.net/">
  <link rel="stylesheet" type="text/css" href="http://cmsj.net/theme/css/normalize.css">
  <link rel="stylesheet" type="text/css" href="http://cmsj.net/theme/css/style.min.css">
  <link rel="stylesheet" type="text/css" href="http://cmsj.net/theme/css/pygments.css">
  <link rel="stylesheet" type="text/css" href="//fonts.googleapis.com/css?family=Roboto+Mono">
  <link rel="stylesheet" type="text/css" href="http://cmsj.net/theme/css/fontawesome-all.min.css">
  <link rel="stylesheet" type="text/css" href="http://cmsj.net/theme/css/hatena-bookmark-icon.css">

  <meta charset="utf-8" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="author" content="Chris Jones">
  <meta name="description" content="Posts and writings by Chris Jones">
  <meta name="og:site_name" content="cmsj.net">

  <!-- Twitter Card -->




  <link href="http://cmsj.net/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="cmsj.net Atom" />


  <title>
    cmsj.net
  </title></head>

<body>
  <main>
    <header>
      <div class="site-name">
        <a href="http://cmsj.net">cmsj.net</a>
      </div>
      <p>
        <a href="http://cmsj.net/archives.html"><i class="fas fa-archive"></i> Archive</a>
      </p>
    </header>

<article>
  <div class="article__title">
    <h1><a href="http://cmsj.net/2009/12/31/python-wanderings-part-two.html">Python wanderings, part two</a></h1>
  </div>
  <div class="article__meta">
    <p class="article__meta__post-date">Posted on: Thu 31 December 2009</p>
    </p>
  </div>
  <div class="article__text">
    <h2>2. Plugging it all in</h2>
<p>Sometimes we get feature requests and merge proposals for features that are clearly useful for someone, but not appropriate for the general use cases. It's always unfortunate to have to say no to these folks, but we have a slim menu UI and I'm wary of cluttering it with niche features. Still, turning away legitimate users is something I don't like doing, so for a while we've been considering how to fix this.
The obvious answer is that we should support plugins, and I've been working on such a system for my epic refactoring. This is a quick wander through some thoughts I've had.
I started out by googling for python plugin systems; One if the top hits was <a href="http://lucumr.pocoo.org/2006/7/3/python-plugin-system">this page</a> by Armin Ronacher . In it he demonstrates a plugin system in under 40 lines of Python. It's simple and flexible, but there are some issues, like it makes doctest very sad.
I asked about this in #python and was politely informed that I was Doing It Wrong. I chatted for a while with the helpful residents and came away with a list of plugin frameworks to look at, namely twisted.plugin and zope.interface.
Pulling in external dependencies is a big deal for us - many of our users are on Ubuntu or similar desktops with lots of python packages already installed, but some are not using GNOME or a Linux desktop at all, so we have to be sure that we need a library before we depend on it.
After playing a little with both of the options I came to the conclusion that while they are both really well made and capable, they are far more formal than we need, and the added dependency issues continued to concern me.
I revisited Armin's plugin system and removed the use of .__subclasses__() that was breaking doctest and offending #python instead having a list in each .py file which the plugin system extracts and treats any classes mentioned in that list as plugins. I also extended it to always instantiate the plugins and look for the plugin files in both the system directories and the user's home directory.
<a href="http://bazaar.launchpad.net/%7Ecmsj/%2Bjunk/terminator-epic-refactor/annotate/head%3A/terminatorlib/plugin.py">This plugin system</a> is currently hooked into two places in the branch, URL mangling and the context menu. This allows plugins to add support for new URL types (e.g. we just added support for Launchpad code URLs like lp:~cmsj/+junk/terminator-epic-refactor), and insert new options into the context menu. I'm not sure if we need to go further, but if you would like to hook into other parts let me know - it's pretty easy to arrange now :)</p>
  </div>
</article>
<hr />
<article>
  <div class="article__title">
    <h1><a href="http://cmsj.net/2009/12/23/python-wanderings-part-one.html">Python wanderings, part one</a></h1>
  </div>
  <div class="article__meta">
    <p class="article__meta__post-date">Posted on: Wed 23 December 2009</p>
    </p>
  </div>
  <div class="article__text">
    <p>As mentioned in my earlier post about refactoring Terminator, I want to talk about some of the things I've learned about Python and programming in the last few months. If I were you I wouldn't place any great significance in anything I'm about to say - after all I'm a rank amateur in the field of programming.
This is going to be a multi-part post so I at least get something out there, rather than leaving it to rot forever in my drafts folder.</p>
<h2>1. Solving global warming^W variables</h2>
<p>I have objects that represent terminal widgets, objects that represent widgets that contain terminals, objects that contain configuration, and one master object that functions as the brains of the operation.
Inevitably these objects need to know about each other, but how to achieve that? The brain object is simply called 'Terminator' and almost every other part of the system needs to know about it, same with the config object, and Terminator needs to know about all of the terminal objects, etc. The dependencies are all over the place and one aim of the re-factor was to separate all these parts out and decouple them, but ultimately I was never going to get away from different objects needing to know about each other.
So how to go about it? As far as I know the options are:
-   pass around object references (every time you create something, pass it your references to all the bits it needs)
    -   Pros: no hacks or tricks involved
    -   Cons: makes every __init__() more complicated, means passing references that an object doesn't need other than to pass to its children.</p>
<ul>
<li>
<p>use global variables</p>
<ul>
<li>Pros: they're global</li>
<li>Cons: everyone seems to hate global variables, perhaps because it's an implicit dependency not an explicit one, or because of potential namespace collisions, or maybe other reasons.</li>
</ul>
</li>
<li>
<p>use singletons</p>
<ul>
<li>Pros: explicit dependency</li>
<li>Cons: often seems to involve hackery to get the singleton object reference</li>
</ul>
</li>
</ul>
<p>In my searching around I came across a fourth option that somewhat relates to singletons... the Borg pattern.
This is a very simple idea - it's a class that always instantiates to the same thing. You don't need a factory or function or something that gives you a reference to the singleton, you just instantiate a class and it's the same as all of the others you've instantiated of the same class.
Best of all, the Borg pattern is incredibly simple in Python. Like, really simple. Don't believe me? Click <a href="http://code.activestate.com/recipes/66531/">here</a>. Yep, four lines of code. Technically it's probably a bit ugly, but the resulting code feels very clean.
So now I have the Borg pattern in use for the main class, a class that provides all the configuration, a class that discovers plugins and lets them be referenced, and a fairly new class I'm experimenting with that acts as a factory for all of my classes, as a way to break any possibility of circular module dependencies.
Reality has to bite though, the Borg isn't a panacea; One has to be very careful about how one creates Borg objects. I chose to create a base class called Borg which Terminator, Config, Factory and PluginRegistry all derive from, but this turns out to have been a very short sighted decision to abstract out the common 4 lines. It wasn't until I started building Config to have functions that allow it to be accessed as a dict that I realised all of my Terminator, Config, Factory and PluginRegistry instances were the same thing as opposed to each type being distinct. It's also terrifyingly important that the subclasses of Borg not use class attributes. Any attributes defined by these classes *must* be instantiated as None so they are instance variables, and *after* you've called Borg.__init__(self) in your own __init__() you can then set up your attributes however you want because they are then part of the shared state.
On the whole I am happy with the Borg pattern. I've written test code to ensure that all of the assumptions I explicitly made are guaranteed, and all of the implicit assumptions I've discovered I made are also safe. Nonetheless, it's not a completely clean solution and I find myself wishing it was somehow a primitive of the language.</p>
  </div>
</article>
<hr />
<article>
  <div class="article__title">
    <h1><a href="http://cmsj.net/2009/12/23/random-musical-linkage.html">Random musical linkage</a></h1>
  </div>
  <div class="article__meta">
    <p class="article__meta__post-date">Posted on: Wed 23 December 2009</p>
    </p>
  </div>
  <div class="article__text">
    <p>I listen to a lot of electronic music and one of the nice things about that is the intermingling of other music by way of samples.
Case in point, I'm currently watching The Ballet Boyz's production of The Rite Of Spring with Rike, and I suddenly realised that the string motif playing at the entrance of The Elders is sampled and looped to great effect by the hypnotic Physical World on Freeland's album Now &amp; Them.
This kind of thing makes me smile :)</p>
  </div>
</article>
<hr />
<article>
  <div class="article__title">
    <h1><a href="http://cmsj.net/2009/12/19/epic-terminator-refactoring-afoot.html">Epic Terminator refactoring afoot</a></h1>
  </div>
  <div class="article__meta">
    <p class="article__meta__post-date">Posted on: Sat 19 December 2009</p>
    </p>
  </div>
  <div class="article__text">
    <p>The current bzr repository for Terminator began its life in November 2006 with the simplest possible implementation of the concept of packing multiple terminals into one window. In the 3 years since then we have expanded and extended the code in a variety of directions to produce a moderately compelling feature set, but one that is really obviously incomplete.
In the same time period we've also seen a really gratifying amount of adoption - I believe our active userbase numbers in the thousands if not tens of thousands. I am forced to largely estimate these numbers for all the usual FOSS reasons, but it's all based on one real metric - Ubuntu has about a million users reporting popcon data and over 10,000 of those have Terminator installed. I don't actually think that they all use it, but nonetheless it's the kind of number that makes you think "hey maybe I need to be doing more for these folks".
And I do think that, and I am trying to do more.
Back in August I took a serious look at where we are and came to the same old conclusions - we lack one or two headline features that people keep asking for (barely a week goes by when I don't get asked how someone can save a particular layout of terminals). These features are very subtle and deeply problematic with the existing code architecture - we've just been hacking in features as we can without any regard for architecture or future maintainability.
I decided that I'd had enough of being confused and frustrated by the status quo and so I started a side branch in my Launchpad /+junk/ folder called "epic-refactor" with the aim of refactoring all of Terminator from scratch. I'd read through every line of existing code and figure out what we were actually doing and how it could fit together more sensibly, then sketch that out in the barest form possible while I experimented with various Python techniques to arrive at an architecture that makes sense for our project, then port over the existing code feature-by-feature to the new architecture.
It's now a little over four months since I started the epic refactor and looking at where I stand today I am really happy. It's not ready to be merged into trunk yet, but the amount of work to get it there is less than the amount of work I've done on it so far. I don't want to put a timescale on it, but I hope to be calling for some wider testing in 2-3 months or less.
Once we are acceptably close to feature parity with the current releases I'll merge the epic-refactor branch over  and we can start to push forward with implementing the features that everyone wants, and finally get to the point of being able to comfortably release a 1.0 version.
I'd always thought that I'd hand over maintainership after a 1.0 version, but the last 4 months have been a whirlwind of programming discovery, so I might very well just stick around and see what people want on the road to a 2.0 release. Alternatively, the work I've been doing in the last few days on a plugin system might mean that I can kick back and watch everyone else implement crazy, awesome and sublime features I'd never thought of!
I'll be back with more when I have written a configuration subsystem for epic-refactor, because by then I'll be wanting your help to test!
I'm also going to write a separate post shortly about some of the interesting Python paradigms and ideas I've hit upon along the way. I'm sure none of it will be a revelation to anyone with serious programming chops, but for a rank amateur like me it would have been useful to have read four months ago ;)</p>
  </div>
</article>
<hr />
<article>
  <div class="article__title">
    <h1><a href="http://cmsj.net/2009/12/03/terminator-014-released.html">Terminator 0.14 released!</a></h1>
  </div>
  <div class="article__meta">
    <p class="article__meta__post-date">Posted on: Thu 03 December 2009</p>
    </p>
  </div>
  <div class="article__text">
    <p>This has been another long gap release unfortunately, but we do have some goodies for you.
Stephen Boddy is back with some excellent re-working of the UI relating to grouping terminals, Kees Cook brings us some clever work relating to window geometry and myself and others have been fixing bugs for you. We hope you enjoy this release, especially those of you who hated the "I'll be back" notifications from 0.13!</p>
<p>Home Page: <a href="http://www.tenshu.net/terminator">http://www.tenshu.net/terminator</a>
Launchpad Page: <a href="http://launchpad.net/terminator">http://launchpad.net/terminator</a>
Ubuntu PPAs: <a href="https://launchpad.net/~gnome-terminator/+archive/ppa">https://launchpad.net/~gnome-terminator/+archive/ppa</a></p>
  </div>
</article>
<hr />
<article>
  <div class="article__title">
    <h1><a href="http://cmsj.net/2009/10/20/rise-of-floating-fonters.html">Rise of the Floating Fonters</a></h1>
  </div>
  <div class="article__meta">
    <p class="article__meta__post-date">Posted on: Tue 20 October 2009</p>
    </p>
  </div>
  <div class="article__text">
    <p>For about two years now I've been using a 127dpi laptop screen as my primary computer display. It's a comfortable thing to be looking at, and after much playing around I've settled on 6.5pt as my ideal application font size.
No problems with that, right? Fontconfig says font sizes are a double (a high precision floating point number), but not all libraries/applications follow this.
In my testing of Karmic I've found two such things that particularly stick out:</p>
<ul>
<li>
<p>notify-osd</p>
<ul>
<li>Assumes font sizes are whole numbers, so ends up using a tiny font</li>
</ul>
</li>
<li>
<p>Gwibber</p>
<ul>
<li>Assumes font sizes are integers and completely fails to run if they are not</li>
</ul>
</li>
</ul>
<p>Obviously this won't do, so I've checked that we have <a href="https://bugs.launchpad.net/ubuntu/+source/notify-osd/+bug/396736">filed</a> <a href="https://bugs.launchpad.net/gwibber/+bug/383759">bugs</a> (and in the case of Gwibber, a patch), but I seem to be meeting some resistance, or this just isn't considered to be a high priority.
Thus a new Launchpad team is born, <a href="https://launchpad.net/~floatingfonters">The Floating Fonters</a>, for exiles such as myself who won't kowtow to the integers. We even have <a href="https://launchpad.net/~floatingfonters/+archive/floatingfixes">a PPA with fixed versions</a> of notify-osd and Gwibber, but no guarantees are included!</p>
  </div>
</article>
<hr />
<article>
  <div class="article__title">
    <h1><a href="http://cmsj.net/2009/10/17/thinkpad-usb-keyboard.html">Thinkpad USB keyboard</a></h1>
  </div>
  <div class="article__meta">
    <p class="article__meta__post-date">Posted on: Sat 17 October 2009</p>
    </p>
  </div>
  <div class="article__text">
    <p>Yesterday I took delivery of a new Thinkpad USB keyboard because I've started putting my laptop up on a stand to be next to it's external monitor.
In so doing I needed a keyboard and the ten quid Logitech was making me very sad, hence the Thinkpad one.
If you've ever typed on a thinkpad you immediately know why this keyboard is awesome :)</p>
<p><img alt="keyboard" src="http://www.tenshu.net/wp-content/uploads/2009/10/l_1600_1200_865448E8-0EFC-41CC-A0F3-82920E4CD51E.jpeg">
<img alt="keyboard" src="http://www.tenshu.net/wp-content/uploads/2009/10/l_1600_1200_F60F9354-27C3-4F49-A275-021CAC524592.jpeg"></p>
  </div>
</article>
<hr />
<article>
  <div class="article__title">
    <h1><a href="http://cmsj.net/2009/10/06/i-waving-i-waving.html">I'm waving I'm waving</a></h1>
  </div>
  <div class="article__meta">
    <p class="article__meta__post-date">Posted on: Tue 06 October 2009</p>
    </p>
  </div>
  <div class="article__text">
    <p>Do you wave? If so, apply some superposition to cmsjtenshu@googlewave.com</p>
  </div>
</article>
<hr />
<article>
  <div class="article__title">
    <h1><a href="http://cmsj.net/2009/09/29/you-know-that-alan-pope.html">You know that Alan "popey" Pope?</a></h1>
  </div>
  <div class="article__meta">
    <p class="article__meta__post-date">Posted on: Tue 29 September 2009</p>
    </p>
  </div>
  <div class="article__text">
    <p>I've always said he's a really amazing guy, you know.</p>
  </div>
</article>
<hr />
<article>
  <div class="article__title">
    <h1><a href="http://cmsj.net/2009/09/25/lifesaver-11-released.html">Lifesaver 1.1 released!</a></h1>
  </div>
  <div class="article__meta">
    <p class="article__meta__post-date">Posted on: Fri 25 September 2009</p>
    </p>
  </div>
  <div class="article__text">
    <p>This release incorporates some bug fixes and some new features: Animation, FriendFeed support, Configuration via gconf keys, Improved visual layout.</p>
<p>Visit <a href="http://launchpad.net/lifesaver">http://launchpad.net/lifesaver</a> for downloads and information about packages for Ubuntu 9.10 (Karmic)</p>
  </div>
</article>

<div class="pagination">
    <ul>
        <li class="pagination__prev">
            <a href="http://cmsj.net/index8.html">&laquo;</a>
        </li>



          <li>
            <a  href="http://cmsj.net/index.html">1</a>
          </li>


                <li>.....</li>
            </li>


                <li>.....</li>
            </li>


                <li>.....</li>
            </li>


                <li>.....</li>
            </li>


          <li>
            <a  href="http://cmsj.net/index6.html">6</a>
          </li>


          <li>
            <a  href="http://cmsj.net/index7.html">7</a>
          </li>


          <li>
            <a  href="http://cmsj.net/index8.html">8</a>
          </li>


          <li>
            <a class="pagination__page--current" href="http://cmsj.net/index9.html">9</a>
          </li>


          <li>
            <a  href="http://cmsj.net/index10.html">10</a>
          </li>


          <li>
            <a  href="http://cmsj.net/index11.html">11</a>
          </li>


          <li>
            <a  href="http://cmsj.net/index12.html">12</a>
          </li>


                <li>.....</li>
            </li>


                <li>.....</li>
            </li>


                <li>.....</li>
            </li>


                <li>.....</li>
            </li>


                <li>.....</li>
            </li>


                <li>.....</li>
            </li>


                <li>.....</li>
            </li>


                <li>.....</li>
            </li>


                <li>.....</li>
            </li>


                <li>.....</li>
            </li>


          <li>
            <a  href="http://cmsj.net/index23.html">23</a>
          </li>

        <li class="pagination__next">
            <a href="http://cmsj.net/index10.html">&raquo;</a>
        </li>
    </ul>
</div>

  </main>
    <footer>
      <div class="author__logo">
          <img src="http://cmsj.net/theme/images/logo.png" alt="logo">
      </div>
      <section class="author">
        <div class="author__name">
          <a href="http://cmsj.net/pages/about.html">Chris Jones</a>
          <p></p>
        </div>
        <div class="author__link">
          <ul>
            <li>
              <a href="https://twitter.com/cmsj" target="_blank" title="twitter">
                <i class="fab fa-twitter-square"></i>
              </a>
            </li>
            <li>
              <a href="https://github.com/cmsj" target="_blank" title="github">
                <i class="fab fa-github-square"></i>
              </a>
            </li>
            <li>
              <a href="http://cmsj.net/feeds/all.atom.xml" target="_blank" title="Feed">
                <i class="fas fa-rss-square"></i>
              </a>
            </li>
          </ul>
        </div>
      </section>
      <div class="ending-message">
        <p>&copy; Chris Jones. Powered by <a href="http://getpelican.com" target="_blank">Pelican</a>, Theme is using <a href="https://github.com/laughk/pelican-hss" target="_blank">HSS</a>. </p>
      </div>
    </footer>
</body>
</html>